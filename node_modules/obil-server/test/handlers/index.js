var test = require('tape');
var sinon = require('sinon');
var handlers = require('../../lib/handlers');
var pkg = require('../../package');

test('Handlers', function(t) {
  t.test('should be called with object', function(tt) {
    var resp = {
      send: sinon.spy()
    };
    var req = {
      app: {
        locals: {
          name: 'obil-service',
          version: '0.0.0'
        }
      }
    };
    handlers.info(req, resp);
    tt.ok(resp.send.calledWith({
      message: 'info',
      service: req.app.locals.name,
      version: req.app.locals.version,
      server: 'obil-server_' + pkg.version,
      nodejs: process.version
    }));
    tt.end();
  });
});
